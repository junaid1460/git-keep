#!/bin/bash
repo=$1
command=$2
# import local files
dir="$(cd $(dirname $0);pwd)"
local_dir="$dir/src"
source "$local_dir/variables.sh"
source "$local_dir/colors.sh"
source "$local_dir/helpers.sh"
source "$local_dir/error.sh"
source "$local_dir/editor.sh"
source "$local_dir/functions.sh"
source "$local_dir/functions.ls.sh"


# change directory to repo
cd $repo 

# if repository not initialized then notify
if [ "$command" != "init" ] && [ "$command" != "-i" ]  && [ ! -d ".git" ]
then
    color $Red
    print "Repository not initialized yet!"
    color $Green
    print "please run :"
    color $Color_Off
    print  "    doc [init|-i]"
    print 
    exit
fi


# commands

if [ $# -gt 0 ]
then
    if [ "$command" == "init" ] || [ "$command" == "-i" ]
    then
        if [ -d ".git" ]
        then
            color $Yellow
            echo "Already Initialized"
        else
            color $UGreen
            echo "Initializing_repo :"
            color $Red
            git init
        fi
    elif [ "$command" == "undo" ] || [ "$command" == "-u" ]
    then
        undo
    elif [ "$command" == "add" ] || [ "$command" == "-a" ]
    then
        add
    elif [ "$command" == "list-files" ] || [ "$command" == "ls" ]
    then
        verify_requirements
        list_info
    else
        color $Red
        echo "Invalid parameters"
        error
    fi
    exit 0

else
    error
fi


color $Color_Off